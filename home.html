<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BSfitness - Home</title>
  <link rel="stylesheet" href="index.css" />
</head>
<body>
  <button class="sidebar-toggle" id="sidebarToggle">â˜° Menu</button>
  
  <div class="sidebar" id="sidebar">
    <h2>BSfitness</h2>
    <ul>
      <li><a href="home.html" class="active">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li id="authLink"><a href="login.html">Login</a></li>
    </ul>
  </div>

  <div class="main" id="main">
    <header>
      <h1>Welcome to BSfitness</h1>
      <div id="userWelcome" style="display: none;">
        Welcome back, <span id="username"></span>!
        <button id="logoutBtn" style="margin-left: 1rem;">Logout</button>
      </div>
    </header>

    <div class="slider-container">
      <img id="sliderImage" src="images/image1.jpg" alt="Slider Image" onclick="goToPage(currentIndex)" />
    </div>

    <section class="vertical-boxes">
      <div class="box" onclick="location.href='bodybuilding.html'">
        <img src="images/bodybuilding.jpg" alt="Body Building" />
        <h3>Body Building</h3>
      </div>
      <div class="box" onclick="location.href='heightgrowth.html'">
        <img src="images/height.jpg" alt="Height Growth" />
        <h3>Height Growth</h3>
      </div>
      <div class="box" onclick="location.href='yoga.html'">
        <img src="images/yoga.jpg" alt="Yoga" />
        <h3>Yoga</h3>
      </div>
    </section>
  </div>
  
  <script src="index.js"></script>
  <script>
    // Sidebar toggle functionality
    const sidebar = document.getElementById('sidebar');
    const main = document.getElementById('main');
    const sidebarToggle = document.getElementById('sidebarToggle');

    sidebarToggle.addEventListener('click', () => {
      sidebar.classList.toggle('active');
      main.classList.toggle('shifted');
    });

    // Close sidebar when clicking outside
    document.addEventListener('click', (e) => {
      if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target) && sidebar.classList.contains('active')) {
        sidebar.classList.remove('active');
        main.classList.remove('shifted');
      }
    });

    // Check authentication state
    const checkAuth = async () => {
      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
      const authLink = document.getElementById('authLink');
      const userWelcome = document.getElementById('userWelcome');
      
      if (isLoggedIn) {
        try {
          const response = await fetch('/api/user');
          if (response.ok) {
            const user = await response.json();
            document.getElementById('username').textContent = user.username;
            userWelcome.style.display = 'block';
            authLink.style.display = 'none';
          } else {
            localStorage.removeItem('isLoggedIn');
            userWelcome.style.display = 'none';
            authLink.style.display = 'block';
          }
        } catch (error) {
          console.error('Error fetching user data:', error);
        }
      } else {
        userWelcome.style.display = 'none';
        authLink.style.display = 'block';
      }
    };

    // Handle logout
    document.getElementById('logoutBtn')?.addEventListener('click', async () => {
      try {
        await fetch('/api/logout', { method: 'POST' });
        localStorage.removeItem('isLoggedIn');
        window.location.reload();
      } catch (error) {
        console.error('Error logging out:', error);
      }
    });

    // Check auth state on page load
    checkAuth();
  </script>
</body>
</html>
